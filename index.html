<html>
    <head>
        <title> Contracts-Go </title>
        <!-- Fonts yo -->
        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
        <link rel="icon" href="img/favicon.ico" type="image/x-icon" />
          <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

        <!-- Firebase auth -->
        <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
        <script src="https://www.gstatic.com/firebasejs/3.2.0/firebase.js"></script>
        <script>
          var config = {
            apiKey: "AIzaSyCQzpSfkf6y8PVUV1pzciwzugWvicebQA0",
            authDomain: "contracts-go.firebaseapp.com",
            databaseURL: "https://contracts-go.firebaseio.com",
            storageBucket: "contracts-go.appspot.com",
          };
          firebase.initializeApp(config);
          var provider = new firebase.auth.GoogleAuthProvider();
        </script>
        
        <!-- CSS -->
        <link type="text/css" rel="stylesheet" href="css/main.css"/>
        <link type="text/css" rel="stylesheet" href="materialize/css/materialize.min.css"  media="screen,projection"/>
        
        <!-- Google log-in -->
        <script type="text/javascript">
        function signIn() {
          if (!firebase.auth().currentUser) {
            var provider = new firebase.auth.GoogleAuthProvider(); //create provider
            provider.addScope('https://www.googleapis.com/auth/plus.login'); // add scopes here
            firebase.auth().signInWithPopup(provider); //sign-in with redirect
          }
        }

        function signOut() {
            firebase.auth().signOut().then(function() {
                document.getElementById('PI-page').style.display = 'none';
                document.getElementById('try-again').style.display = 'none';
                document.getElementById('home-page').style.display = 'block';
                }, function(error) {
                    console.log("error");
            });
        }
        window.onload = function() {
          document.getElementById('PI-page').style.display = 'none';
          firebase.auth().getRedirectResult().then(function(result) {
                var user = result.user;
              })
              firebase.auth().onAuthStateChanged(function(user) {
                if (user.email.endsWith('stevens.edu')) {
                    document.getElementById('home-page').style.display = 'none';
                    document.getElementById('try-again').style.display = 'none';
                    document.getElementById('PI-page').style.display = 'block';
                    var name = user.displayName;
                    var email = user.email;
                    document.getElementById('name-prompt').innerHTML = 'Hey ' + name.substr(0,name.indexOf(' ')) + '.';
                    $( "input[name='name']" ).val(name);
                    $( "input[name='email']" ).val(email);
                }
                else{
                    document.getElementById('home-page').style.display = 'none';
                    document.getElementById('try-again').style.display = 'block';
                }
              })
          document.getElementById('get-started').addEventListener('click', signIn, false);
        };     
         
        </script>
    </head>
    <body>
    <!-- Materialize js -->
    <script type="text/javascript" src="materialize/js/materialize.min.js"></script>
        
    <div id="home-page">
        <div id="container">
            <header>
                <img src="img/not-a-logo.png" id="logo">
                <p id="tagline"> Creating non-disclosure agreements has never been so easy. </p>
                <div class="button" id="get-started"> Get Started </div>
                <p class="caption"> By signing in with your Stevens account. </p>
            </header>
            <div id="moreInfo">
                <div class="description">
                    <img src="img/fast.png" class="icon">
                    <h1> Fast </h1>
                    <p> Just step through a few questions and we'll have your document generated in no time. </p>
                </div>
                <div class="description" id="middle_desc">
                    <img src="img/reliable.png" class="wide-icon">
                    <h1> Reliable </h1>
                    <p> We get your documents where they need to go, when they need to go. </p>
                </div>
                <div class="description">
                    <img src="img/easy.png" class="icon">
                    <h1> Easy </h1>
                    <p> No scanning documents. No sending emails. No hassle. </p>
                </div>
            </div>
            <footer>
                <p> Copyright &copy; Contacts-Go 2016 </p>
            </footer>
        </div>
    </div>
    
        <div id="PI-page">
            <div id="container">
            <header>
                <img src="img/not-a-logo.png" id="logo">
            </header>
            <p id="name-prompt"> </p>
            <p class="caption_text"> We'll need just a few bits of information before we can generate your document. All fields are required. </p>
        <div class="row">
        <form class="col s12" id="form">
            <!-- About you -->
            <i class="material-icons small" style="margin-top: 12px; margin-left:  10px; float: left;">assignment_ind</i>
            <h2 class="form_headers">
 First, about you.</h2>
            <div class="row">
            <div class="input-field col s6">
                <input placeholder="Placeholder" name="name" id="name" type="text" class="validate"><label for="name" data-error="Your full name is required.">Full Name</label>
            </div>
            <div class="input-field col s6">
              <input placeholder="Placeholder" disabled id="email" name="email" type="email" class="validate"><label data-error="Please enter a valid email." for="email">Email</label>
            </div>
              <div class="input-field col s12">
              <input name="title" id="title" type="text" class="validate"><label for="title" data-error="A title is required.">Title</label>
            </div>
            </div>
            
            <!-- About the project -->
            <div class="row">
            <i class="material-icons small" style=" margin-left:  10px; float: left;">assignment</i>
            <h2 class="form_headers"> Next, about the project.</h2>
            
            <div class="input-field col s12">
              <input name="industry" id="industry" type="text" class="validate">
              <label for="industry" data-error="An industry is required."> Industry </label>
            </div>
            
            <div class="input-field col s12">
                <textarea name="project_description" id="project_description" class="materialize-textarea" length="350"></textarea>
                <label for="project_description" data-error="A project description is required.">Project Description</label>
            </div>
            </div>
            
            <!-- About the company -->
            <div class="row">
            <i class="material-icons small" style=" margin-left:  10px; float: left;">business</i>
            <h2 class="form_headers"> Now, about the company involved.</h2>
            <div class="input-field col s6">
              <input name="company_name" id="company_name" type="text" class="validate">
              <label for="company_name" data-error="A company name is required.">Company Name</label>
            </div>
            
            <div class="input-field col s6">
            <select name="company_location" id="company_location">
                <option value="" disabled selected> Select </option>
                <option value="Alabama">Alabama</option>
                <option value="Alaska">Alaska</option>
                <option value="Arizona">Arizona</option>
                <option value="Arkansas">Arkansas</option>
                <option value="California">California</option>
                <option value="Colorado">Colorado</option>
                <option value="Connecticut">Connecticut</option>
                <option value="Delaware">Delaware</option>
                <option value="District Of Columbia">District Of Columbia</option>
                <option value="Florida">Florida</option>
                <option value="Georgia">Georgia</option>
                <option value="Hawaii">Hawaii</option>
                <option value="Idaho">Idaho</option>
                <option value="Illinois">Illinois</option>
                <option value="Indiana">Indiana</option>
                <option value="Iowa">Iowa</option>
                <option value="Kansas">Kansas</option>
                <option value="Kentucky">Kentucky</option>
                <option value="Louisiana">Louisiana</option>
                <option value="Maine">Maine</option>
                <option value="Maryland">Maryland</option>
                <option value="Massachusetts">Massachusetts</option>
                <option value="Michigan">Michigan</option>
                <option value="Minnesota">Minnesota</option>
                <option value="Mississippi">Mississippi</option>
                <option value="Missouri">Missouri</option>
                <option value="Montana">Montana</option>
                <option value="Nebraska">Nebraska</option>
                <option value="Nevada">Nevada</option>
                <option value="New Hampshire">New Hampshire</option>
                <option value="New Jersey">New Jersey</option>
                <option value="New Mexico">New Mexico</option>
                <option value="New York">New York</option>
                <option value="North Carolina">North Carolina</option>
                <option value="North Dakota">North Dakota</option>
                <option value="Ohio">Ohio</option>
                <option value="Oklahoma">Oklahoma</option>
                <option value="Oregon">Oregon</option>
                <option value="Pennsylvania">Pennsylvania</option>
                <option value="Rhode Island">Rhode Island</option>
                <option value="South Carolina">South Carolina</option>
                <option value="South Dakota">South Dakota</option>
                <option value="Tennessee">Tennessee</option>
                <option value="Texas">Texas</option>
                <option value="Utah">Utah</option>
                <option value="Vermont">Vermont</option>
                <option value="Virginia">Virginia</option>
                <option value="Washington">Washington</option>
                <option value="West Virginia">West Virginia</option>
                <option value="Wisconsin">Wisconsin</option>
                <option value="Wyoming">Wyoming</option>
            </select>
            <label for="company_location">Company Location</label>
          </div>
            
            
            <div class="input-field col s6">
              <input name="company_type" id="company_type" type="text" class="validate">
              <label for="company_type" data-error="A company type is required."  data-error="Please select a state.">Company Type</label>
            </div>
            
            <div class="input-field col s6">
            <select name="company_state" id="company_state">
                <option value="" disabled selected> Select </option>
                <option value="Alabama">Alabama</option>
                <option value="Alaska">Alaska</option>
                <option value="Arizona">Arizona</option>
                <option value="Arkansas">Arkansas</option>
                <option value="California">California</option>
                <option value="Colorado">Colorado</option>
                <option value="Connecticut">Connecticut</option>
                <option value="Delaware">Delaware</option>
                <option value="District Of Columbia">District Of Columbia</option>
                <option value="Florida">Florida</option>
                <option value="Georgia">Georgia</option>
                <option value="Hawaii">Hawaii</option>
                <option value="Idaho">Idaho</option>
                <option value="Illinois">Illinois</option>
                <option value="Indiana">Indiana</option>
                <option value="Iowa">Iowa</option>
                <option value="Kansas">Kansas</option>
                <option value="Kentucky">Kentucky</option>
                <option value="Louisiana">Louisiana</option>
                <option value="Maine">Maine</option>
                <option value="Maryland">Maryland</option>
                <option value="Massachusetts">Massachusetts</option>
                <option value="Michigan">Michigan</option>
                <option value="Minnesota">Minnesota</option>
                <option value="Mississippi">Mississippi</option>
                <option value="Missouri">Missouri</option>
                <option value="Montana">Montana</option>
                <option value="Nebraska">Nebraska</option>
                <option value="Nevada">Nevada</option>
                <option value="New Hampshire">New Hampshire</option>
                <option value="New Jersey">New Jersey</option>
                <option value="New Mexico">New Mexico</option>
                <option value="New York">New York</option>
                <option value="North Carolina">North Carolina</option>
                <option value="North Dakota">North Dakota</option>
                <option value="Ohio">Ohio</option>
                <option value="Oklahoma">Oklahoma</option>
                <option value="Oregon">Oregon</option>
                <option value="Pennsylvania">Pennsylvania</option>
                <option value="Rhode Island">Rhode Island</option>
                <option value="South Carolina">South Carolina</option>
                <option value="South Dakota">South Dakota</option>
                <option value="Tennessee">Tennessee</option>
                <option value="Texas">Texas</option>
                <option value="Utah">Utah</option>
                <option value="Vermont">Vermont</option>
                <option value="Virginia">Virginia</option>
                <option value="Washington">Washington</option>
                <option value="West Virginia">West Virginia</option>
                <option value="Wisconsin">Wisconsin</option>
                <option value="Wyoming">Wyoming</option>
            </select>
            <label for="company_state" data-error="Please select a state.">State of Incorporation</label>
          </div>
            <div class="input-field col s6">
              <input name="company_contact_name" id="company_contact_name" type="text" class="validate"><label for="company_contact_name" data-error="A company contact name is required">Company Contact Name</label>
            </div>
                
            <div class="input-field col s6">
              <input name="company_contact_email" id="company_contact_email" type="email" class="validate"> <label data-error="A valid email is required." for="company_contact_email" >Company Contact Email</label>
            </div>
                
        </div>  
            <i class="material-icons small" style=" margin-left:  10px; float: left;">mode_edit</i>
            <h2 class="form_headers"> Finally, about the agreement.</h2>
            <div class="row">
              <div class="input-field col s12">
                    <select name="type" id="nda_type">
                        <option value="" disabled selected> Select </option>
                        <option value="disclosing">Stevens is the Discloser</option>
                        <option value="recipient">Stevens is the Recepient</option>
                        <option value="mutual">Mutual</option>
                    </select>
                </div>
            </div>
                      <input type="submit" value="Go" id="go_button" class="hoverable">
                </form>
            </div>
                
            <div id="sign-out">
                <p> Want to come back later? </p>
                <a onclick="signOut()" style="text-decoration: underline; cursor:pointer; margin-top: 30px;"> Sign Out </a>
            </div>
            <footer>
                <p> Copyright &copy; Contacts-Go 2016 </p>
            </footer>
        </div>
        </div>
        
        <div id="try-again">
            <div id="container">
            <header>
                <img src="img/not-a-logo.png" id="logo">
            </header>
            <p class="green_title"> Sorry. </p>
            <p class="caption_text"> You need a valid Stevens email to create a document.</p>
            <div class="button" onClick="signOut()" style="margin-top: 0px"> Try again. </div>
            </div>  
        </div>
                
        
    <script>
    $( "#form" ).submit(function( event ) {
        event.preventDefault();
        var errorCount = 0;
        var $fields = $("#form :input")
        $($fields).append($("#form select"));
        for (i=0; i<15; i++){
            if (i==1) {i=2;}
            if (!($($fields[i]).val())){
                var id = $fields[i].id;
                console.log(id);
                if (id == 'company_state'  || id == 'company_location' || id == "nda_type"){
                    switch(id){
                        case 'company_location':
                        $($('input.select-dropdown')[0]).css("border-bottom", "2px solid #F44336");
                        case 'company_state':
                        $($('input.select-dropdown')[1]).css("border-bottom", "2px solid #F44336");
                        case 'nda_type':
                        $($('input.select-dropdown')[2]).css("border-bottom", "2px solid #F44336");
                    }
                    
                }
                else{
                    $("#" + id).addClass("invalid");
                    $("#" + id).prop("aria-invalid", "true");
                    $("label[for=\'" + id + "\']").addClass("active");
                    errorCount++;
                }
                }
            }
        
        if(errorCount == 0){
            type = $( '#nda_type').val(),
        
        name = $( "input[name='name']" ).val(),
        email = $( "input[name='email']" ).val(),
        title = $( "input[name='title']" ).val(),
            
        company_type = $( "input[name='company_type']" ).val(),
        company_name = $( "input[name='company_name']" ).val(),
        company_state = $( "select[name='company_state']" ).val(),
        company_location = $( "input[name='company_location_state']" ).val(),
        company_contact_name = $( "input[name='company_contact_name']" ).val(),
        company_contact_email = $( "input[name='company_contact_email']" ).val(),
        
        industry = $( "input[name='industry']" ).val(),
        project_description = $( "input[name='project_description']" ).val(),
        
        url = "http://api.contractsgo.com/generate";
        
        data = {"pi":{
                    "name": name,
                    "email" : email,
                    "title": title,
                },
                "company":{
                    "type": company_type,
                    "name": company_name,
                    "state": company_state,
                    "location": company_location,
                    "contact":{
                        "name": company_contact_name,
                        "email": company_contact_email
                    }
                },
                "project":{
                    "industry": industry,
                    "description": project_description
                },
                "type": type,
                "emailTo":{
                    "name": "David",
                    "email": "fbueti@gmail.com"
                }
            },
          
            $.ajax({
              type: "POST",
              url: url,
              data: data,
              dataType: "json"
            }).done(function(response) {
            console.log(data);
            console.log(response);
        });
            
        }
    });
        </script>
             <script>
        $(document).ready(function() {
            $('select').material_select();
            if(($("#name").val())){
                $("#name").css("border-bottom", "2px solid #00a63f");
            }
            
            /* work-around for materialize select/text-area error checking */
            $( "#company_location" ).change(function() {
                $($('input.select-dropdown')[0]).css("border-bottom", "2px solid #00a63f");
            });
            $( "#company_state" ).change(function() {
                $($('input.select-dropdown')[1]).css("border-bottom", "2px solid #00a63f");
            });
            $( "#nda_type" ).change(function() {
                $($('input.select-dropdown')[2]).css("border-bottom", "2px solid #00a63f");
            });
            $("#project_description").change(function() {
                if(($(this).val())){
                    $(this).css("border-bottom", "2px solid #00a63f");
                }
                else{
                    $(this).css("border-bottom", "1px solid #9e9e9e");
                }
            });
        });
        </script>
    </body>
</html>